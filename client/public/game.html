<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="/eneba-logo.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Game</title>
  <style>
    :root{ --bg:#45229c; --border:rgba(255,255,255,0.12); --text:#fff; --muted:rgba(255,255,255,0.75); }
    body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:var(--bg); color:var(--text); }
    .wrap{ max-width: 900px; margin: 0 auto; padding: 24px 18px; }
    .back{ color: var(--muted); text-decoration:none; display:inline-block; margin-bottom: 14px; }
    .card{ border:1px solid var(--border); border-radius: 14px; overflow:hidden; background: rgba(0,0,0,0.16); }
    .cover{ width:100%; height:420px; object-fit:cover; display:block; background: rgba(0,0,0,0.2); }
    .body{ padding: 16px; }
    .muted{ color: var(--muted); }
  </style>
</head>
<body>
  <div class="wrap">
    <a class="back" href="/">← Back</a>

    <div class="card">
      <img id="cover" class="cover" src="/game-placeholder.png" alt="" />
      <div class="body">
        <h2 id="title" style="margin:0 0 6px 0;">Loading...</h2>
        <div id="meta" class="muted">—</div>
        <div id="note" class="muted" style="margin-top:10px;font-size:13px;"></div>
      </div>
    </div>
  </div>

<script>
  const id = new URLSearchParams(location.search).get("id");

  const cover = document.getElementById("cover");
  const title = document.getElementById("title");
  const meta = document.getElementById("meta");
  const note = document.getElementById("note");

  const API_BASE = "http://localhost:5174";

  async function load() {
    if (!id) {
      title.textContent = "Not found";
      meta.textContent = "—";
      note.textContent = "No id provided.";
      return;
    }

    try {
      const r = await fetch(`${API_BASE}/api/games/${encodeURIComponent(id)}`, {
        cache: "no-store",
      });
      if (!r.ok) throw new Error(`HTTP ${r.status}`);

      const g = await r.json();

      title.textContent = g.title ?? "Game";
      meta.textContent = `${g.platform ?? "—"} • ${g.region ?? "—"} • €${Number(g.price_eur ?? 0).toFixed(2)}`;
      cover.src = g.image_url || "/game-placeholder.png";
      note.textContent = `cashback: €${Number(g.cashback_eur ?? 0).toFixed(2)} • discount: ${g.discount_percent ?? 0}%`;
    } catch (e) {
      title.textContent = "Not found";
      meta.textContent = "—";
      note.textContent = "Game not found or backend is not running.";
      cover.src = "/game-placeholder.png";
    }
  }

  load();
</script>



</body>
</html>
